"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2531],{2531:(E,I,a)=>{a.r(I),a.d(I,{AdminModule:()=>u});var A=a(6814),_=a(3699),e=a(6689);const o=[{path:"",loadChildren:()=>Promise.resolve().then(a.bind(a,9633)).then(g=>g.TabsPageModule)}];let x=(()=>{var g;class y{}return(g=y).\u0275fac=function(p){return new(p||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[_.Bz.forChild(o),_.Bz]}),y})();var v=a(9633);let u=(()=>{var g;class y{}return(g=y).\u0275fac=function(p){return new(p||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[A.ez,x,v.TabsPageModule]}),y})()},3369:(E,I,a)=>{a.r(I),a.d(I,{AdministrationModule:()=>X});var A=a(6814),_=a(3699),e=a(6689),o=a(9810);function x(i,d){if(1&i){const c=e.EpF();e.TgZ(0,"ion-col",4),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.navigateAccess())}),e.TgZ(1,"div",2),e._UZ(2,"ion-icon",7),e.qZA(),e.TgZ(3,"ion-label"),e._uU(4,"Link"),e.qZA()()}}let v=(()=>{var i;class d{constructor(t){this.router=t,this.roles=[]}ngOnInit(){}ionViewWillEnter(){this.roles=localStorage.getItem("roles")}navigate(){this.router.navigate(["admin/administration/users"])}navigateFCT(){this.router.navigate(["admin/administration/fct"])}navigateAccess(){this.router.navigate(["admin/access"])}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(_.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-admin"]],decls:18,vars:2,consts:[[1,"ion-padding",3,"fixed"],["size","4","data-testid","Users",1,"ion-padding",3,"click"],[1,"reduced-padding-bottom"],["name","person","color","primary","size","large"],["size","4","data-testid","FCT",1,"ion-padding",3,"click"],["name","clipboard","color","secondary","size","large"],["size","4","class","ion-padding","data-testid","FCT",3,"click",4,"ngIf"],["name","key","color","secondary","size","large"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Admin"),e.qZA()()(),e.TgZ(4,"ion-content")(5,"ion-grid",0)(6,"ion-row")(7,"ion-col",1),e.NdJ("click",function(){return n.navigate()}),e.TgZ(8,"div",2),e._UZ(9,"ion-icon",3),e.qZA(),e.TgZ(10,"ion-label"),e._uU(11,"Users"),e.qZA()(),e.TgZ(12,"ion-col",4),e.NdJ("click",function(){return n.navigateFCT()}),e.TgZ(13,"div",2),e._UZ(14,"ion-icon",5),e.qZA(),e.TgZ(15,"ion-label"),e._uU(16,"FCT"),e.qZA()(),e.YNc(17,x,5,0,"ion-col",6),e.qZA()()()),2&t&&(e.xp6(5),e.Q6J("fixed",!0),e.xp6(12),e.Q6J("ngIf",n.roles.includes("manager")||n.roles.includes("admin")))},dependencies:[A.O5,o.wI,o.W2,o.jY,o.Gu,o.gu,o.Q$,o.Nd,o.wd,o.sr],styles:["ion-col[_ngcontent-%COMP%]{text-align:center}.reduced-padding-bottom[_ngcontent-%COMP%]{padding-bottom:5px}"]}),d})(),u=(()=>{var i;class d{constructor(){}ngOnInit(){}}return(i=d).\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-role"]],decls:2,vars:0,template:function(t,n){1&t&&(e.TgZ(0,"p"),e._uU(1," role works!\n"),e.qZA())}}),d})();var g=a(5861),y=a(5619),m=a(3970);function p(i,d){if(1&i){const c=e.EpF();e.TgZ(0,"ion-card",2),e.NdJ("click",function(){const r=e.CHM(c).$implicit,s=e.oxw();return e.KtG(s.navigate(r.userId))}),e.TgZ(1,"ion-card-content")(2,"ion-row")(3,"ion-col",7),e._uU(4),e.qZA()()()()}if(2&i){const c=d.$implicit;e.xp6(4),e.AsE(" ",c.lastName,", ",c.givenName," ")}}let Z=(()=>{var i;class d{constructor(t,n){this.router=t,this.pouchService=n,this.mothersSubject=new y.X([]),this.results=[]}ngOnInit(){}ionViewWillEnter(){this.getMothers()}navigate(t){this.router.navigate([t])}handleInput(t){const n=t.target.value.toLowerCase();this.mothersSubject.subscribe(r=>{this.results=r.filter(s=>{if(s.lastName)return s.lastName.toLowerCase().indexOf(n)>-1})})}getMothers(){var t=this;return(0,g.Z)(function*(){try{const{docs:n}=yield t.pouchService.allMothersDb.find({selector:{roles:{$nin:["admin"]}}}),r=n.map(s=>({id:s._id,lastName:s.lastName,givenName:s.givenName,userId:s.userId}));t.mothersSubject.next(r)}catch(n){console.log(n)}})()}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(_.F0),e.Y36(m.M))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-user"]],decls:14,vars:3,consts:[["slot","start"],["slot","end"],[3,"click"],[1,"ion-padding",3,"fixed"],[3,"debounce","ionInput"],["search",""],[3,"click",4,"ngFor","ngForOf"],["size","8",1,"d-flex","ion-align-items-center","ion-justify-content-start","ion-no-padding"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return n.navigate("/admin/administration/users/forms/add")}),e._uU(6,"Add"),e.qZA()(),e.TgZ(7,"ion-title"),e._uU(8,"Users"),e.qZA()()(),e.TgZ(9,"ion-content")(10,"ion-grid",3)(11,"ion-searchbar",4,5),e.NdJ("ionInput",function(s){return n.handleInput(s)}),e.qZA(),e.YNc(13,p,5,2,"ion-card",6),e.qZA()()),2&t&&(e.xp6(10),e.Q6J("fixed",!0),e.xp6(1),e.Q6J("debounce",1e3),e.xp6(2),e.Q6J("ngForOf",n.results))},dependencies:[A.sg,o.YG,o.Sm,o.PM,o.FN,o.wI,o.W2,o.jY,o.Gu,o.Nd,o.VI,o.wd,o.sr,o.j9,o.oU]}),d})();var h=a(95),l=a(6188),b=a(7105);let C=(()=>{var i;class d{constructor(t,n,r,s,w,D){this.formBuilder=t,this.mNService=n,this.router=r,this.toastController=s,this.route=w,this.loginService=D,this.alertButtons=["Delete"]}ionViewWillEnter(){}ngOnInit(){this.regForm=this.formBuilder.group({username:[""],password:[""],roles:this.formBuilder.array(["rnd"]),facility:["Facility A"],email:[""],lastName:[""],givenName:[""],middleName:[""]})}onSubmit(){const t=this.regForm.value;this.loginService.regAdmin({username:t.username,password:t.password,roles:t.roles},{lastName:t.lastName,givenName:t.givenName,middleName:t.middleName,email:t.email,roles:t.roles,facility:t.facility}).subscribe({next:s=>{console.log("Registration successful:",s),this.presentToast("Registration successful"),this.router.navigate(["/admin/administration/users"])},error:s=>{console.error("Registration failed:",s)}})}showPassword(t){t.type="password"===t.type?"text":"password"}presentToast(t){var n=this;return(0,g.Z)(function*(){yield(yield n.toastController.create({message:t,duration:1500,position:"top"})).present()})()}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(h.qu),e.Y36(l.R),e.Y36(_.F0),e.Y36(o.yF),e.Y36(_.gz),e.Y36(b.r))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-edit-user"]],decls:27,vars:2,consts:[["slot","start"],[3,"formGroup","ngSubmit"],["label","Username","formControlName","username","labelPlacement","stacked"],["label","Password","formControlName","password","type","password","labelPlacement","stacked"],["input",""],[3,"name","click"],["label","Email","formControlName","email","type","email","labelPlacement","stacked"],["label","Last Name","formControlName","lastName","labelPlacement","stacked"],["label","Given Name","formControlName","givenName","labelPlacement","stacked"],["label","Middle Name","formControlName","middleName","labelPlacement","stacked"],[1,"d-flex","ion-justify-content-center"],["type","submit"]],template:function(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Add User"),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"form",1),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(8,"ion-card")(9,"ion-list")(10,"ion-item"),e._UZ(11,"ion-input",2),e.qZA(),e.TgZ(12,"ion-item"),e._UZ(13,"ion-input",3,4),e.TgZ(15,"ion-icon",5),e.NdJ("click",function(){e.CHM(r);const w=e.MAs(14);return e.KtG(n.showPassword(w))}),e.qZA()(),e.TgZ(16,"ion-item"),e._UZ(17,"ion-input",6),e.qZA(),e.TgZ(18,"ion-item"),e._UZ(19,"ion-input",7),e.qZA(),e.TgZ(20,"ion-item"),e._UZ(21,"ion-input",8),e.qZA(),e.TgZ(22,"ion-item"),e._UZ(23,"ion-input",9),e.qZA()()(),e.TgZ(24,"ion-row",10)(25,"ion-button",11),e._uU(26,"Save"),e.qZA()()()()}if(2&t){const r=e.MAs(14);e.xp6(7),e.Q6J("formGroup",n.regForm),e.xp6(8),e.Q6J("name","password"==r.type?"eye-outline":"eye-off-outline")}},dependencies:[o.YG,o.Sm,o.PM,o.W2,o.Gu,o.gu,o.pK,o.Ie,o.q_,o.Nd,o.wd,o.sr,o.j9,o.oU,h._Y,h.JJ,h.JL,h.sg,h.u]}),d})();function S(i,d){if(1&i&&(e.TgZ(0,"ion-card",6)(1,"ion-card-content")(2,"ion-row")(3,"ion-col",7),e._uU(4,"Code "),e.qZA(),e.TgZ(5,"ion-col",8),e._uU(6),e.qZA()(),e.TgZ(7,"ion-row")(8,"ion-col",7),e._uU(9,"Name En "),e.qZA(),e.TgZ(10,"ion-col",8),e._uU(11),e.qZA()(),e.TgZ(12,"ion-row")(13,"ion-col",7),e._uU(14,"Name Ph "),e.qZA(),e.TgZ(15,"ion-col",8),e._uU(16),e.qZA()()()()),2&i){const c=d.$implicit;e.MGl("routerLink","/admin/administration/fct/forms/edit/",c.id,""),e.xp6(6),e.hij("",c.code," "),e.xp6(5),e.hij("",c.nameen," "),e.xp6(5),e.hij("",c.nameph," ")}}let J=(()=>{var i;class d{constructor(t,n){this.router=t,this.pouchService=n,this.fctsSubject=new y.X([]),this.results=[]}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,g.Z)(function*(){yield t.getFCT()})()}getFCT(){var t=this;return(0,g.Z)(function*(){try{let{rows:n}=yield t.pouchService.fct.allDocs({include_docs:!0});const r=n.map(s=>({id:s.doc._id,code:s.doc.code,nameen:s.doc.nameen,nameph:s.doc.nameph,species:s.doc.species}));t.fctsSubject.next(r)}catch(n){console.log(n)}})()}handleInput(t){const n=t.target.value.toLowerCase();this.fctsSubject.subscribe(r=>{this.results=r.filter(s=>{if(s.nameen)return s.nameen.toLowerCase().indexOf(n)>-1})})}navigate(t){console.log(t),console.log(),this.router.navigate([t])}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(_.F0),e.Y36(m.M))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-food-composition-table"]],decls:12,vars:2,consts:[["slot","start"],["slot","end"],[3,"click"],[1,"ion-padding"],[3,"debounce","ionInput"],["class","ion-no-padding",3,"routerLink",4,"ngFor","ngForOf"],[1,"ion-no-padding",3,"routerLink"],["size","4",1,"d-flex","ion-justify-content-start"],["size","8",1,"d-flex","ion-justify-content-start"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return n.navigate("admin/administration/fct/forms/add")}),e._uU(6,"Add"),e.qZA()(),e.TgZ(7,"ion-title"),e._uU(8,"Food Composition Table"),e.qZA()()(),e.TgZ(9,"ion-content",3)(10,"ion-searchbar",4),e.NdJ("ionInput",function(s){return n.handleInput(s)}),e.qZA(),e.YNc(11,S,17,4,"ion-card",5),e.qZA()),2&t&&(e.xp6(10),e.Q6J("debounce",1e3),e.xp6(1),e.Q6J("ngForOf",n.results))},dependencies:[A.sg,_.rH,o.YG,o.Sm,o.PM,o.FN,o.wI,o.W2,o.Gu,o.Nd,o.VI,o.wd,o.sr,o.j9,o.oU,o.YI]}),d})();var Y=a(5472),L=a(4532);function O(i,d){1&i&&(e.TgZ(0,"ion-title"),e._uU(1,"Add Food"),e.qZA())}function f(i,d){1&i&&(e.TgZ(0,"ion-title"),e._uU(1,"Edit Food"),e.qZA())}function N(i,d){if(1&i){const c=e.EpF();e.TgZ(0,"ion-buttons",10)(1,"ion-button",11),e._uU(2,"Delete"),e.qZA(),e.TgZ(3,"ion-alert",12),e.NdJ("ionAlertDidDismiss",function(n){e.CHM(c);const r=e.oxw();return e.KtG(r.delete(n))}),e.qZA()()}if(2&i){const c=e.oxw();e.xp6(3),e.Q6J("buttons",c.alertButtons)}}let F=(()=>{var i;class d{constructor(t,n,r,s,w,D,j){this.route=t,this.formBuilder=n,this.toastController=r,this.router=s,this.pouchService=w,this.utilsService=D,this.navCtrl=j,this.id=String(this.route.snapshot.paramMap.get("id")),this.alertButtons=["Delete"]}ngOnInit(){this.fctForm=this.formBuilder.group({id:[""],code:[""],nameen:[""],nameph:[""],species:[""]})}ionViewWillEnter(){this.getFct()}onSubmit(){var t=this;return(0,g.Z)(function*(){const n=t.fctForm.value,r={_id:n.id,code:n.code,nameen:n.nameen,nameph:n.nameph,species:n.species};try{if(r._id){const s=yield t.pouchService.fct.get(t.id);r._rev=s._rev,yield t.pouchService.fct.put(r),t.presentToast("FCT updated")}else r._id=t.utilsService.generateId(),yield t.pouchService.fct.put(r),t.presentToast("FCT added");t.pouchService.fct.replicate.to(t.pouchService.customRemote("fct","shared"),{retry:!0}),t.navCtrl.pop()}catch(s){console.log(s)}})()}getFct(){var t=this;return(0,g.Z)(function*(){if("null"!==t.id)try{let n=yield t.pouchService.fct.get(t.id);t.fctForm.setValue({id:n._id,code:n.code,nameen:n.nameen,nameph:n.nameph,species:n.species})}catch(n){console.log(n)}})()}presentToast(t){var n=this;return(0,g.Z)(function*(){yield(yield n.toastController.create({message:t,duration:1500,position:"top"})).present()})()}delete(t){var n=this;return(0,g.Z)(function*(){if("backdrop"!==t.detail.role)try{const r=yield n.pouchService.fct.get(n.id);yield n.pouchService.fct.remove(r).then(s=>{n.pouchService.fct.replicate.to(n.pouchService.customRemote("fct","shared"),{retry:!0}),n.navCtrl.pop(),n.presentToast("FCT deleted")})}catch(r){console.log(r)}})()}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(_.gz),e.Y36(h.qu),e.Y36(o.yF),e.Y36(_.F0),e.Y36(m.M),e.Y36(L.F),e.Y36(Y.SH))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-add-edit-fct"]],decls:22,vars:4,consts:[[4,"ngIf"],["slot","start"],["slot","end",4,"ngIf"],[3,"formGroup","ngSubmit"],["label","Code","formControlName","code","id","code","labelPlacement","stacked","value",""],["label","English Name","formControlName","nameen","id","nameen","labelPlacement","stacked","value",""],["label","Filipino Name","formControlName","nameph","id","nameph","labelPlacement","stacked","value",""],["label","Species","formControlName","species","id","species","labelPlacement","stacked","value",""],[2,"display","flex","justify-content","center"],["type","submit"],["slot","end"],["id","present-alert"],["trigger","present-alert","header","Delete Food","message","Are you sure you want to delete food?",3,"buttons","ionAlertDidDismiss"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar"),e.YNc(2,O,2,0,"ion-title",0),e.YNc(3,f,2,0,"ion-title",0),e.TgZ(4,"ion-buttons",1),e._UZ(5,"ion-back-button"),e.qZA(),e.YNc(6,N,4,1,"ion-buttons",2),e.qZA()(),e.TgZ(7,"ion-content")(8,"form",3),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(9,"ion-card")(10,"ion-list")(11,"ion-item"),e._UZ(12,"ion-input",4),e.qZA(),e.TgZ(13,"ion-item"),e._UZ(14,"ion-input",5),e.qZA(),e.TgZ(15,"ion-item"),e._UZ(16,"ion-input",6),e.qZA(),e.TgZ(17,"ion-item"),e._UZ(18,"ion-input",7),e.qZA()()(),e.TgZ(19,"ion-row",8)(20,"ion-button",9),e._uU(21,"Save"),e.qZA()()()()),2&t&&(e.xp6(2),e.Q6J("ngIf","null"==n.id),e.xp6(1),e.Q6J("ngIf","null"!=n.id),e.xp6(3),e.Q6J("ngIf","null"!=n.id),e.xp6(2),e.Q6J("formGroup",n.fctForm))},dependencies:[A.O5,o.Ge,o.YG,o.Sm,o.PM,o.W2,o.Gu,o.pK,o.Ie,o.q_,o.Nd,o.wd,o.sr,o.j9,o.oU,h._Y,h.JJ,h.JL,h.sg,h.u]}),d})();const T=["search"];function U(i,d){if(1&i){const c=e.EpF();e.TgZ(0,"ion-card",5),e.NdJ("click",function(){const r=e.CHM(c).$implicit,s=e.oxw();return e.KtG(s.navigate(r.userId))}),e.TgZ(1,"ion-card-content")(2,"ion-row")(3,"ion-col",6),e._uU(4),e.qZA()()()()}if(2&i){const c=d.$implicit;e.xp6(4),e.AsE(" ",c.lastName,", ",c.givenName," ")}}let M=(()=>{var i;class d{constructor(t,n){this.router=t,this.pouchService=n,this.mothersSubject=new y.X([]),this.results=[]}ngOnInit(){}ionViewWillEnter(){this.getMothers()}navigate(t){localStorage.setItem("mother_userId",t),console.log(t),this.router.navigate(["/admin/access/list"])}handleInput(t){const n=t.target.value.toLowerCase();this.mothersSubject.subscribe(r=>{this.results=r.filter(s=>{if(s.lastName)return s.lastName.toLowerCase().indexOf(n)>-1}),console.log(this.results)})}getMothers(){var t=this;return(0,g.Z)(function*(){try{const{docs:n}=yield t.pouchService.allMothersDb.find({selector:{roles:{$in:["mother"]}}}),r=n.map(s=>({id:s._id,lastName:s.lastName,givenName:s.givenName,userId:s.userId}));t.mothersSubject.next(r)}catch(n){console.log(n)}})()}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(_.F0),e.Y36(m.M))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-access"]],viewQuery:function(t,n){if(1&t&&e.Gf(T,5),2&t){let r;e.iGM(r=e.CRH())&&(n.search=r.first)}},decls:11,vars:3,consts:[["slot","start"],[1,"ion-padding",3,"fixed"],[3,"debounce","ionInput"],["search",""],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["size","8",1,"d-flex","ion-align-items-center","ion-justify-content-start","ion-no-padding"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Search Mother"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-grid",1)(8,"ion-searchbar",2,3),e.NdJ("ionInput",function(s){return n.handleInput(s)}),e.qZA(),e.YNc(10,U,5,2,"ion-card",4),e.qZA()()),2&t&&(e.xp6(7),e.Q6J("fixed",!0),e.xp6(1),e.Q6J("debounce",1e3),e.xp6(2),e.Q6J("ngForOf",n.results))},dependencies:[A.sg,o.Sm,o.PM,o.FN,o.wI,o.W2,o.jY,o.Gu,o.Nd,o.VI,o.wd,o.sr,o.j9,o.oU]}),d})();function P(i,d){if(1&i){const c=e.EpF();e.TgZ(0,"ion-button",7),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.setApproval("approved"))}),e._uU(1," Link Account "),e.qZA()}}function G(i,d){if(1&i){const c=e.EpF();e.TgZ(0,"ion-button",7),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.setApproval("approved"))}),e._uU(1," Approve "),e.qZA()}}function R(i,d){if(1&i){const c=e.EpF();e.TgZ(0,"ion-button",7),e.NdJ("click",function(){e.CHM(c);const n=e.oxw();return e.KtG(n.setApproval("denied"))}),e._uU(1," Deny "),e.qZA()}}let B=(()=>{var i;class d{constructor(t,n,r,s,w,D,j){this.route=t,this.formBuilder=n,this.toastController=r,this.router=s,this.pouchService=w,this.utilsService=D,this.navCtrl=j,this.id=String(this.route.snapshot.paramMap.get("id")),this.rndSubject=new y.X({givenName:"",lastName:""}),this.rnd$=this.rndSubject.asObservable()}ngOnInit(){this.accessForm=this.formBuilder.group({_id:[""],motherId:[""],rndId:[""],rndGivenName:[""],rndLastName:[""],approved:["pending"]})}ionViewWillEnter(){this.getAccessRND()}getAccessRND(){var t=this;return(0,g.Z)(function*(){if(t.pouchService.motherDb||t.pouchService.reiniMotherPouch(),"null"!==t.id)try{let n=yield t.pouchService.accessDb.get(t.id);t.accessForm.setValue({_id:n._id,motherId:n.motherId,rndId:n.rndId,approved:n.approved,rndGivenName:n.rndGivenName,rndLastName:n.rndLastName}),t.rndSubject.next({givenName:n.rndGivenName,lastName:n.rndLastName})}catch(n){console.log(n)}else try{const n=yield t.pouchService.allMothersDb.get(localStorage.getItem("selected_rnd"));t.rndSubject.next({givenName:n.givenName,lastName:n.lastName})}catch(n){console.log(n)}})()}onSubmit(){var t=this;return(0,g.Z)(function*(){const n=t.accessForm.value,r={_id:n._id,motherId:n.motherId?n.motherId:localStorage.getItem("selected_mother"),rndId:n.rndId?n.rndId:localStorage.getItem("selected_rnd"),rndGivenName:n.rndGivenName,rndLastName:n.rndLastName,approved:n.approved};t.rndSubject.subscribe(s=>{r.rndGivenName=s.givenName,r.rndLastName=s.lastName});try{if(r._id){if("denied"===r.approval){const s=yield t.pouchService.accessDb.get(t.id);r._rev=s._rev,yield t.pouchService.accessDb.remove(r)}else{const s=yield t.pouchService.accessDb.get(t.id);r._rev=s._rev,yield t.pouchService.accessDb.put(r)}t.presentToast("RND Updated")}else r._id=t.utilsService.generateId(),yield t.pouchService.accessDb.put(r),t.presentToast("RND Added");yield t.pouchService.accessDb.replicate.to(t.pouchService.customRemote("access-"+localStorage.getItem("mother_userId"),"by-id"),{retry:!0}),t.navCtrl.pop()}catch(s){console.log(s)}})()}setApproval(t){this.accessForm.patchValue({approved:t})}presentToast(t){var n=this;return(0,g.Z)(function*(){yield(yield n.toastController.create({message:t,duration:1500,position:"top"})).present()})()}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(_.gz),e.Y36(h.qu),e.Y36(o.yF),e.Y36(_.F0),e.Y36(m.M),e.Y36(L.F),e.Y36(Y.SH))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-form",5,"z"]],decls:20,vars:10,consts:[["slot","start"],[1,"ion-justify-content-between"],[1,"no-wrap"],[1,"ion-text-nowrap"],[3,"formGroup","ngSubmit"],[2,"display","flex","justify-content","center"],["type","submit",3,"click",4,"ngIf"],["type","submit",3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Manage Permission"),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-card")(8,"ion-card-content")(9,"ion-row",1)(10,"ion-item",2)(11,"ion-label",3),e._uU(12),e.ALo(13,"async"),e.ALo(14,"async"),e.qZA()()()()(),e.TgZ(15,"form",4),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(16,"ion-row",5),e.YNc(17,P,2,0,"ion-button",6),e.YNc(18,G,2,0,"ion-button",6),e.YNc(19,R,2,0,"ion-button",6),e.qZA()()()),2&t){let r;e.xp6(12),e.AsE("",null==(r=e.lcZ(13,6,n.rnd$))?null:r.lastName,", ",null==(r=e.lcZ(14,8,n.rnd$))?null:r.givenName,""),e.xp6(3),e.Q6J("formGroup",n.accessForm),e.xp6(2),e.Q6J("ngIf",""==n.accessForm.controls._id.value),e.xp6(1),e.Q6J("ngIf",""!=n.accessForm.controls._id.value&&"pending"==n.accessForm.controls.approved.value),e.xp6(1),e.Q6J("ngIf",""!=n.accessForm.controls._id.value&&"pending"==n.accessForm.controls.approved.value)}},dependencies:[A.O5,o.YG,o.Sm,o.PM,o.FN,o.W2,o.Gu,o.Ie,o.Q$,o.Nd,o.wd,o.sr,o.oU,h._Y,h.JL,h.sg,A.Ov]}),d})();var q=a(2548);function Q(i,d){1&i&&(e.TgZ(0,"ion-item")(1,"ion-badge",8),e._uU(2,"approved"),e.qZA()())}function z(i,d){1&i&&(e.TgZ(0,"ion-item")(1,"ion-badge",9),e._uU(2,"pending"),e.qZA()())}function k(i,d){if(1&i&&(e.TgZ(0,"div")(1,"a",3)(2,"ion-card")(3,"ion-card-content")(4,"ion-row",4)(5,"ion-item",5)(6,"ion-label",6),e._uU(7),e.qZA()(),e.YNc(8,Q,3,0,"ion-item",7),e.YNc(9,z,3,0,"ion-item",7),e.qZA()()()()()),2&i){const c=d.$implicit;e.xp6(1),e.MGl("routerLink","/admin/access/form/",c._id,""),e.xp6(6),e.AsE("",c.rndLastName,", ",c.rndGivenName,""),e.xp6(1),e.Q6J("ngIf","approved"==c.approved),e.xp6(1),e.Q6J("ngIf","pending"==c.approved)}}const W=[{path:"",component:v},{path:"administration/users",component:Z},{path:"administration/users/forms/add",component:C},{path:"administration/users/forms/edit/:id",component:C},{path:"administration/role",component:u},{path:"administration/fct",component:J},{path:"administration/fct/forms/add",component:F},{path:"administration/fct/forms/edit/:id",component:F},{path:"access",component:M},{path:"access/list",component:(()=>{var i;class d{constructor(t,n){this.pouchService=t,this.loadingService=n,this.accessSubject=new y.X([]),this.access$=this.accessSubject.asObservable()}ngOnInit(){return(0,g.Z)(function*(){})()}ionViewWillEnter(){var t=this;return(0,g.Z)(function*(){t.loadingService.show();try{yield t.getAccess()}catch(n){console.error("Error when retrieving access from CouchDB:",n)}finally{t.loadingService.hide()}})()}getAccess(){var t=this;return(0,g.Z)(function*(){yield t.pouchService.getAccessData();try{const{rows:n}=yield t.pouchService.accessDb.allDocs({include_docs:!0});console.log(n);const r=n.map(s=>({_id:s.doc._id,motherId:s.doc.motherId,rndId:s.doc.rndId,rndGivenName:s.doc.rndGivenName,rndLastName:s.doc.rndLastName,approved:s.doc.approved}));console.log(r),t.accessSubject.next(r)}catch(n){console.log(n)}})()}}return(i=d).\u0275fac=function(t){return new(t||i)(e.Y36(m.M),e.Y36(q.b))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-list"]],decls:13,vars:4,consts:[["slot","start"],[1,"ion-padding",3,"fixed"],[4,"ngFor","ngForOf"],["routerLinkActive","active","ariaCurrentWhenActive","page",3,"routerLink"],[1,"ion-justify-content-between"],[1,"no-wrap"],[1,"ion-text-nowrap"],[4,"ngIf"],["color","success","slot","end"],["color","secondary","slot","end"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Access"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-grid",1)(8,"ion-row")(9,"h1"),e._uU(10,"Linked Accounts"),e.qZA()(),e.YNc(11,k,10,5,"div",2),e.ALo(12,"async"),e.qZA()()),2&t&&(e.xp6(7),e.Q6J("fixed",!0),e.xp6(4),e.Q6J("ngForOf",e.lcZ(12,2,n.access$)))},dependencies:[A.sg,A.O5,_.rH,_.Od,o.yp,o.Sm,o.PM,o.FN,o.W2,o.jY,o.Gu,o.Ie,o.Q$,o.Nd,o.wd,o.sr,o.oU,o.Fo,A.Ov]}),d})()},{path:"access/form",component:B},{path:"access/form/:id",component:B}];let K=(()=>{var i;class d{}return(i=d).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[_.Bz.forChild(W),_.Bz]}),d})(),X=(()=>{var i;class d{}return(i=d).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[A.ez,K,o.Pc,h.UX]}),d})()},6188:(E,I,a)=>{a.d(I,{R:()=>v});var A=a(5861),_=a(4004),e=a(6689),o=a(3401),x=a(3699);let v=(()=>{var u;class g{constructor(m,p){this.storageService=m,this.route=p,this.currentWater={id:"null",scheduleId:"",amount:0},this.currentMealId=""}getAll(m){var p=this;return(0,A.Z)(function*(){return yield p.storageService.get(m)})()}set(m,p){this.getAll(m).then(Z=>{Z.push(p),this.storageService.set(m,Z)})}getKeys(){this.storageService.getKeys().then(m=>{console.log(m)})}getById(m,p){var Z=this;return(0,A.Z)(function*(){return yield Z.storageService.get(m).then(h=>h.find(l=>l.id===p)).catch(h=>h)})()}getAllByRefId(m,p,Z){var h=this;return(0,A.Z)(function*(){return yield h.getAll(m).then(l=>{console.log(l);let b=[];return l.forEach(C=>{C[p]===Z&&b.push(C)}),b}).catch(l=>l)})()}addUpdateElement(m,p){var Z=this;return(0,A.Z)(function*(){console.log(m),console.log(p),yield Z.getAll(m).then(h=>{let l=!1;h.forEach(b=>{if(p.id===b.id)for(var C in console.log("match found"),l=!0,b)b[C]=p[C]}),!1===l&&h.push(p),Z.storageService.set(m,h)})})()}seedSchedule(m){this.getAll("schedule").then(p=>{let Z=[];new Date(2023,11,4),new Date(2023,11,5),new Date(2023,11,6);for(let l=0;l<3;l++){let b=new Date;b.setDate(b.getDate()+l);let C={id:(0,_.Z)(),maternalNutritionId:m,startDate:b};Z.push(C.id),p.push(C)}return this.storageService.set("schedule",p),Z}).then(p=>{this.seedMeals(p)})}seedMeals(m){this.getAll("meal").then(p=>{let Z=["breakfast","lunch","dinner"];m.forEach(h=>{Z.forEach(l=>{let b={id:(0,_.Z)(),scheduleId:h,type:l,imageRef:""};p.push(b)})}),this.storageService.set("meal",p)})}updateCurrentSched(m){var p=this;return(0,A.Z)(function*(){return p.getById("schedule",m).then(Z=>(p.currentSched=Z,Z))})()}updateMeals(m){var p=this;return(0,A.Z)(function*(){return p.getAllByRefId("meal","scheduleId",m).then(Z=>{let h={breakfast:"",lunch:"",dinner:""};return Z.forEach(l=>{switch(l.type){case"breakfast":h.breakfast=l.id;break;case"lunch":h.lunch=l.id;break;case"dinner":h.dinner=l.id}}),h})})()}updateMn(m){var p=this;return(0,A.Z)(function*(){return p.getById("maternalNutrition",m).then(Z=>(p.currentMn=Z,Z))})()}}return(u=g).\u0275fac=function(m){return new(m||u)(e.LFG(o.V),e.LFG(x.gz))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),g})()},9633:(E,I,a)=>{a.r(I),a.d(I,{TabsPageModule:()=>h});var A=a(6814),_=a(95),e=a(9810),o=a(3699),x=a(5619),v=a(6689);function u(l,b){1&l&&(v.TgZ(0,"ion-tab-button",6),v._UZ(1,"ion-icon",7),v._uU(2," Admin "),v.qZA())}const y=[{path:"",component:(()=>{var l;class b{constructor(){this.accessSubj=new x.X(!1),this.access$=this.accessSubj.asObservable()}ngOnInit(){}ionViewWillEnter(){var S;this.accessSubj.next(!1),null!==(S=localStorage.getItem("roles"))&&void 0!==S&&S.includes("admin")&&this.accessSubj.next(!0)}}return(l=b).\u0275fac=function(S){return new(S||l)},l.\u0275cmp=v.Xpm({type:l,selectors:[["app-tabs"]],decls:10,vars:3,consts:[["slot","bottom"],["tab","patient"],["name","home"],["tab","administration",4,"ngIf"],["tab","user"],["name","person"],["tab","administration"],["name","briefcase"]],template:function(S,J){1&S&&(v.TgZ(0,"ion-tabs")(1,"ion-tab-bar",0)(2,"ion-tab-button",1),v._UZ(3,"ion-icon",2),v._uU(4," Home "),v.qZA(),v.YNc(5,u,3,0,"ion-tab-button",3),v.ALo(6,"async"),v.TgZ(7,"ion-tab-button",4),v._UZ(8,"ion-icon",5),v._uU(9," Profile "),v.qZA()()()),2&S&&(v.xp6(5),v.Q6J("ngIf",v.lcZ(6,1,J.access$)))},dependencies:[A.O5,e.gu,e.yq,e.ZU,e.UN,A.Ov]}),b})(),children:[{path:"administration",loadChildren:()=>Promise.resolve().then(a.bind(a,3369)).then(l=>l.AdministrationModule)},{path:"user",loadChildren:()=>Promise.resolve().then(a.bind(a,3771)).then(l=>l.UserModule)},{path:"patient",loadChildren:()=>Promise.all([a.e(9739),a.e(8630)]).then(a.bind(a,8630)).then(l=>l.PatientModule)},{path:"",redirectTo:"/admin/patient",pathMatch:"full"}]},{path:"",redirectTo:"/admin/patient",pathMatch:"full"}];let m=(()=>{var l;class b{}return(l=b).\u0275fac=function(S){return new(S||l)},l.\u0275mod=v.oAB({type:l}),l.\u0275inj=v.cJS({imports:[o.Bz.forChild(y),o.Bz]}),b})();var p=a(3369),Z=a(3771);let h=(()=>{var l;class b{}return(l=b).\u0275fac=function(S){return new(S||l)},l.\u0275mod=v.oAB({type:l}),l.\u0275inj=v.cJS({imports:[A.ez,_.u5,e.Pc,m,p.AdministrationModule,Z.UserModule]}),b})()},3771:(E,I,a)=>{a.r(I),a.d(I,{UserModule:()=>O});var A=a(6814),_=a(3699),e=a(6689),o=a(1971),x=a(2333),v=a(3970),u=a(9810);const g=function(){return["/login/reset-password"]},y=function(){return["./delete"]},m=function(){return["../../login/login"]};let p=(()=>{var f;class N{constructor(T,U,M){this.userService=T,this.authService=U,this.pouchService=M,this.alertButtons=["Confirm"]}ngOnInit(){}logout(){this.userService.clearLoggedUserMother(),localStorage.clear(),this.authService.logout()}deleteAccount(){this.userService.deleteUser()}}return(f=N).\u0275fac=function(T){return new(T||f)(e.Y36(o.K),e.Y36(x.e),e.Y36(v.M))},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-profile"]],decls:18,vars:7,consts:[[3,"routerLink"],["trigger","present-alert","header","Deactivate Account","message","Are you sure you want to deactivate account?",3,"buttons"],[3,"routerLink","click"]],template:function(T,U){1&T&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"My Profile"),e.qZA()()(),e.TgZ(4,"ion-content")(5,"a",0)(6,"ion-card")(7,"ion-card-content"),e._uU(8," Reset Password "),e.qZA()()(),e.TgZ(9,"a",0)(10,"ion-card")(11,"ion-card-content"),e._uU(12," Deactivate Account "),e._UZ(13,"ion-alert",1),e.qZA()()(),e.TgZ(14,"a",2),e.NdJ("click",function(){return U.logout()}),e.TgZ(15,"ion-card")(16,"ion-card-content"),e._uU(17," Sign Out "),e.qZA()()()()),2&T&&(e.xp6(5),e.Q6J("routerLink",e.DdM(4,g)),e.xp6(4),e.Q6J("routerLink",e.DdM(5,y)),e.xp6(4),e.Q6J("buttons",U.alertButtons),e.xp6(1),e.Q6J("routerLink",e.DdM(6,m)))},dependencies:[_.rH,u.Ge,u.PM,u.FN,u.W2,u.Gu,u.wd,u.sr,u.Fo],styles:["a[_ngcontent-%COMP%]{color:#000;width:100%;text-align:center}"]}),N})();var Z=a(5861),h=a(9862),l=a(9397),b=a(6306),C=a(8504);const Y=[{path:"",component:p},{path:"delete",component:(()=>{var f;class N{constructor(T,U,M,P){this.userService=T,this.router=U,this.toastController=M,this.http=P}ngOnInit(){}deleteAccount(){var T=this;const U=new h.WM({"Content-type":"application/json"}),M=localStorage.getItem("username");this.http.delete(`http://18.140.63.176:80/api/users/deactivate/${M}`,{headers:U}).pipe((0,l.b)(function(){var P=(0,Z.Z)(function*(G){console.log(G),localStorage.clear(),T.router.navigate(["/login/login"])});return function(G){return P.apply(this,arguments)}}()),(0,b.K)(P=>(console.log(P.error),(0,C._)(()=>new Error(P.error.msg))))).subscribe()}presentToast(T){var U=this;return(0,Z.Z)(function*(){yield(yield U.toastController.create({message:T,duration:1500,position:"top"})).present()})()}}return(f=N).\u0275fac=function(T){return new(T||f)(e.Y36(o.K),e.Y36(_.F0),e.Y36(u.yF),e.Y36(h.eN))},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-delete",5,"a"]],decls:13,vars:0,consts:[["slot","start"],[1,"ion-padding","ion-text-center"],[1,"d-flex","ion-justify-content-center"],["type","submit",3,"click"]],template:function(T,U){1&T&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Deactivate Account"),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"div",1)(8,"p"),e._uU(9," Are you sure you want to deactivate account? "),e.qZA()(),e.TgZ(10,"ion-row",2)(11,"ion-button",3),e.NdJ("click",function(){return U.deleteAccount()}),e._uU(12,"Confirm Deactivation"),e.qZA()()())},dependencies:[u.YG,u.Sm,u.W2,u.Gu,u.Nd,u.wd,u.sr,u.oU],styles:[".d-flex[_ngcontent-%COMP%]{display:flex}"]}),N})()},{path:"notifications",component:(()=>{var f;class N{constructor(){}ngOnInit(){}}return(f=N).\u0275fac=function(T){return new(T||f)},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-notifications"]],decls:16,vars:0,consts:[["slot","start"],[1,"ion-padding"],[1,"border-1"],["size","10"],["size","2"]],template:function(T,U){1&T&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Notifications"),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button"),e.qZA()()(),e.TgZ(6,"ion-content",1)(7,"form")(8,"ion-card")(9,"ion-list")(10,"ion-item",2)(11,"ion-col",3)(12,"p"),e._uU(13,"All Notifications"),e.qZA()(),e.TgZ(14,"ion-col",4),e._UZ(15,"ion-checkbox"),e.qZA()()()()()())},dependencies:[u.Sm,u.PM,u.nz,u.wI,u.W2,u.Gu,u.Ie,u.q_,u.wd,u.sr,u.w,u.oU]}),N})()}];let L=(()=>{var f;class N{}return(f=N).\u0275fac=function(T){return new(T||f)},f.\u0275mod=e.oAB({type:f}),f.\u0275inj=e.cJS({imports:[_.Bz.forChild(Y),_.Bz]}),N})(),O=(()=>{var f;class N{}return(f=N).\u0275fac=function(T){return new(T||f)},f.\u0275mod=e.oAB({type:f}),f.\u0275inj=e.cJS({imports:[A.ez,L,u.Pc]}),N})()}}]);